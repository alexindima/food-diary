<div class="recipe-list" fdPageContainer #container>
    <fd-page-header
        class="recipe-list__header"
        [title]="'RECIPE_LIST.TITLE' | translate"
        [subtitle]="'RECIPE_LIST.SUBTITLE' | translate"
    >
        <ng-container fdPageHeaderActions>
            <div class="recipe-list__controls">
                <form class="recipe-list__search-form" [formGroup]="searchForm">
                    <fd-ui-input class="recipe-list__search-input"
                        formControlName="search"
                        [label]="'RECIPE_LIST.SEARCH_LABEL' | translate"
                        prefixIcon="search"
                        suffixButtonIcon="close"
                        [suffixButtonAriaLabel]="'COMMON.CLEAR' | translate"
                        [placeholder]="'RECIPE_LIST.SEARCH_PLACEHOLDER' | translate"
                        (suffixButtonClicked)="clearSearch()"
                     />
                </form>

                <div class="recipe-list__filters">
                    <fd-ui-button class="recipe-list__pill"
                        variant="secondary"
                        fill="outline"
                        [icon]="searchForm.controls.onlyMine.value ? 'person' : 'groups'"
                        [ariaLabel]="
                            searchForm.controls.onlyMine.value
                                ? ('RECIPE_LIST.SHOW_ALL_RECIPES' | translate)
                                : ('RECIPE_LIST.ONLY_MY_RECIPES' | translate)
                        "
                        (click)="toggleOnlyMine()"
                        [class.recipe-list__pill--active]="searchForm.controls.onlyMine.value"
                    >
                        {{ searchForm.controls.onlyMine.value
                            ? ('RECIPE_LIST.ONLY_MY_RECIPES' | translate)
                            : ('RECIPE_LIST.SHOW_ALL_RECIPES' | translate) }}
                    </fd-ui-button>
                    <fd-ui-button
                        class="recipe-list__add-button"
                        variant="primary"
                        fill="solid"
                        icon="add"
                        [ariaLabel]="'RECIPE_LIST.ADD_RECIPE_BUTTON' | translate"
                        (click)="onAddRecipeClick()"
                    >
                        {{ 'RECIPE_LIST.ADD_RECIPE_BUTTON' | translate }}
                    </fd-ui-button>
                </div>
            </div>
        </ng-container>
    </fd-page-header>

    <fd-page-body>
        @if (recipeData.isLoading()) {
            <fd-ui-loader class="recipe-list__loader" />
        } @else {
            @if (hasVisibleRecipes) {
                <div class="recipe-list__groups">
                    @if (showRecentSection) {
                        <div class="recipe-list__section">
                            <div class="recipe-list__section-header">
                                <span class="recipe-list__section-label">
                                    {{ 'RECIPE_LIST.RECENT_RECIPES' | translate }}
                                </span>
                                <span class="recipe-list__section-line"></span>
                            </div>
                            <div class="recipe-list__section-grid">
                                @for (recipe of recentRecipes; track recipe.id) {
                                    <fd-recipe-card
                                        [recipe]="recipe"
                                        [imageUrl]="resolveImage(recipe)"
                                        (open)="onRecipeClick(recipe)"
                                        (addToMeal)="onAddToMeal(recipe)"
                                    />
                                }
                            </div>
                        </div>
                    }

                    @if (allRecipesSectionItems.length > 0) {
                        <div class="recipe-list__section">
                            <div class="recipe-list__section-header">
                                <span class="recipe-list__section-label">
                                    {{ 'RECIPE_LIST.ALL_RECIPES' | translate }}
                                </span>
                                <span class="recipe-list__section-line"></span>
                            </div>
                            <div class="recipe-list__section-grid">
                                @for (recipe of allRecipesSectionItems; track recipe.id) {
                                    <fd-recipe-card
                                        [recipe]="recipe"
                                        [imageUrl]="resolveImage(recipe)"
                                        (open)="onRecipeClick(recipe)"
                                        (addToMeal)="onAddToMeal(recipe)"
                                    />
                                }
                            </div>
                        </div>
                    }
                </div>
            } @else {
                <div class="recipe-list__no-results">
                    <mat-icon class="recipe-list__no-results-icon">search_off</mat-icon>
                    {{ 'RECIPE_LIST.NO_RECIPES_FOUND' | translate }}
                </div>
            }
        }

        @if (recipeData.totalPages > 1) {
            <fd-ui-pagination class="recipe-list__pagination"
                [length]="recipeData.totalItems"
                [pageSize]="pageSize"
                [pageIndex]="currentPageIndex"
                (pageIndexChange)="onPageChange($event)"
             />
        }
    </fd-page-body>
</div>

