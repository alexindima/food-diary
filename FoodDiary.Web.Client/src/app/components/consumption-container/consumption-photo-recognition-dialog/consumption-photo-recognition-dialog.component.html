<fd-ui-dialog
    [title]="'CONSUMPTION_MANAGE.PHOTO_AI_DIALOG.TITLE' | translate"
    [subtitle]="'CONSUMPTION_MANAGE.PHOTO_AI_DIALOG.SUBTITLE' | translate"
    size="lg"
>
    <div class="photo-ai-dialog">
        <fd-image-upload-field
            [label]="'CONSUMPTION_MANAGE.PHOTO_AI_DIALOG.UPLOAD_LABEL' | translate"
            [description]="'CONSUMPTION_MANAGE.PHOTO_AI_DIALOG.UPLOAD_DESC' | translate"
            [recommendedSize]="'CONSUMPTION_MANAGE.PHOTO_AI_DIALOG.UPLOAD_RECOMMENDED' | translate"
            [cropEnabled]="true"
            [cropSize]="null"
            [cropMaxSize]="1024"
            [cropAspectRatio]="null"
            [deleteOnClear]="true"
            (imageChanged)="onImageChanged($event)"
        />

        @if (isLoading()) {
            <div class="photo-ai-dialog__loader">
                <fd-ui-loader />
                <div class="photo-ai-dialog__loader-text">
                    {{ 'CONSUMPTION_MANAGE.PHOTO_AI_DIALOG.LOADING' | translate }}
                </div>
            </div>
        } @else {
            @if (errorKey()) {
                <div class="photo-ai-dialog__error">
                    {{ errorKey() | translate }}
                </div>
            }

            @if (results().length) {
                <div class="photo-ai-dialog__results">
                    <div class="photo-ai-dialog__results-title">
                        {{ 'CONSUMPTION_MANAGE.PHOTO_AI_DIALOG.RESULTS_TITLE' | translate }}
                    </div>
                    <div class="photo-ai-dialog__results-grid">
                        <div class="photo-ai-dialog__results-row" *ngFor="let item of results(); let i = index">
                            <fd-ui-input
                                [label]="'CONSUMPTION_MANAGE.PHOTO_AI_DIALOG.NAME_LABEL' | translate"
                                [ngModel]="getDisplayName(item)"
                                [ngModelOptions]="{ standalone: true }"
                                [readonly]="true"
                            />
                            <fd-ui-input
                                [label]="'CONSUMPTION_MANAGE.PHOTO_AI_DIALOG.AMOUNT_LABEL' | translate"
                                [ngModel]="item.amount"
                                [ngModelOptions]="{ standalone: true }"
                                [readonly]="true"
                                type="number"
                            />
                            <div class="photo-ai-dialog__unit">
                                <span class="photo-ai-dialog__unit-label">
                                    {{ 'CONSUMPTION_MANAGE.PHOTO_AI_DIALOG.UNIT_LABEL' | translate }}
                                </span>
                                <span class="photo-ai-dialog__unit-value">
                                    {{ item.unit }}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            }
        }
    </div>

    <div fdUiDialogFooter class="photo-ai-dialog__actions">
        <fd-ui-button fill="outline" variant="secondary" (click)="close()">
            {{ 'CONSUMPTION_MANAGE.PHOTO_AI_DIALOG.CLOSE' | translate }}
        </fd-ui-button>
    </div>
</fd-ui-dialog>
