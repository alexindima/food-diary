<aside class="sidebar">
    <div class="sidebar__brand">
        <div class="sidebar__logo">
            <img src="assets/images/header/logo.svg" alt="Food Diary" />
        </div>
        <div class="sidebar__brand-text">
            <span class="sidebar__brand-title">Food Diary</span>
            <span class="sidebar__brand-plan">Pro</span>
        </div>
    </div>

    <nav class="sidebar__nav">
        <a routerLink="/" routerLinkActive="is-active" [routerLinkActiveOptions]="{ exact: true }" class="sidebar__link">
            <mat-icon>dashboard</mat-icon>
            <span>Dashboard</span>
        </a>
    </nav>

    <div class="sidebar__section">
        <button class="sidebar__section-header" type="button" (click)="toggleFoodTracking()">
            <span>Food tracking</span>
            <mat-icon [class.is-open]="isFoodTrackingOpen()">expand_more</mat-icon>
        </button>
        @if (isFoodTrackingOpen()) {
            <nav class="sidebar__nav sidebar__nav--secondary">
                <a routerLink="/consumptions" routerLinkActive="is-active" class="sidebar__link sidebar__link--secondary">
                    <mat-icon>restaurant_menu</mat-icon>
                    <span>Food Diary</span>
                </a>
                <a routerLink="/products" routerLinkActive="is-active" class="sidebar__link sidebar__link--secondary">
                    <mat-icon>inventory_2</mat-icon>
                    <span>Products</span>
                </a>
                <a routerLink="/recipes" routerLinkActive="is-active" class="sidebar__link sidebar__link--secondary">
                    <mat-icon>restaurant</mat-icon>
                    <span>Recipes</span>
                </a>
            </nav>
        }
    </div>

    <div class="sidebar__section">
        <button class="sidebar__section-header" type="button" (click)="toggleBodyTracking()">
            <span>Body tracking</span>
            <mat-icon [class.is-open]="isBodyTrackingOpen()">expand_more</mat-icon>
        </button>
        @if (isBodyTrackingOpen()) {
            <nav class="sidebar__nav sidebar__nav--secondary">
                <a routerLink="/weight-history" routerLinkActive="is-active" class="sidebar__link sidebar__link--secondary">
                    <mat-icon>monitor_weight</mat-icon>
                    <span>Weight</span>
                </a>
                <a routerLink="/waist-history" routerLinkActive="is-active" class="sidebar__link sidebar__link--secondary">
                    <mat-icon>straighten</mat-icon>
                    <span>Waist</span>
                </a>
                <a routerLink="/cycle-tracking" routerLinkActive="is-active" class="sidebar__link sidebar__link--secondary">
                    <mat-icon>favorite</mat-icon>
                    <span>Cycle</span>
                </a>
            </nav>
        }
    </div>

    <div class="sidebar__spacer"></div>

    <nav class="sidebar__nav sidebar__nav--secondary sidebar__nav--bottom">
        <a routerLink="/statistics" routerLinkActive="is-active" class="sidebar__link sidebar__link--secondary">
            <mat-icon>bar_chart</mat-icon>
            <span>Reports</span>
        </a>
        <a routerLink="/goals" routerLinkActive="is-active" class="sidebar__link sidebar__link--secondary">
            <mat-icon>flag</mat-icon>
            <span>Goals</span>
        </a>
        <a routerLink="/profile" routerLinkActive="is-active" class="sidebar__link sidebar__link--secondary">
            <mat-icon>settings</mat-icon>
            <span>Settings</span>
        </a>
    </nav>

    @if (currentUser(); as user) {
        <div class="sidebar__user-wrapper">
            <button type="button" class="sidebar__user" (click)="toggleUserMenu()">
                @if (user.profileImage) {
                    <div class="sidebar__avatar sidebar__avatar--image">
                        <img [src]="user.profileImage" alt="Avatar" />
                    </div>
                } @else {
                    <div class="sidebar__avatar">
                        {{ (user.username || user.email || 'U') | slice:0:1 | uppercase }}
                    </div>
                }
                <div class="sidebar__user-meta">
                    <div class="sidebar__user-name">{{ user.username || user.email }}</div>
                    <div class="sidebar__user-plan">Free Account</div>
                </div>
                <mat-icon class="sidebar__user-arrow" [class.is-open]="isUserMenuOpen()">expand_less</mat-icon>
            </button>

            @if (isUserMenuOpen()) {
                <div class="sidebar__user-menu">
                    <button type="button" class="sidebar__logout" (click)="logout()">
                        <mat-icon>logout</mat-icon>
                        <span>{{ 'HEADER.LOGOUT' | translate }}</span>
                    </button>
                </div>
            }
        </div>
    }
</aside>
