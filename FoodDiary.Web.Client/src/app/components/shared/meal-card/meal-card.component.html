<div class="meal-card" (click)="handleOpen()">
    <div class="meal-card__header">
        <div class="meal-card__meta">
            <div class="meal-card__icon">
                <img [ngSrc]="coverImage()" width="48" height="48" alt="" loading="lazy" />
            </div>
            <div class="meal-card__titles">
                <div class="meal-card__title">
                    @if (meal().mealType) {
                        {{ ('MEAL_CARD.MEAL_TYPES.' + meal().mealType) | translate }}
                    } @else {
                        {{ 'MEAL_CARD.MEAL_TYPES.OTHER' | translate }}
                    }
                </div>
                <div class="meal-card__time">
                    {{ meal().date | date:'HH:mm' }}
                </div>
            </div>
        </div>
        <div class="meal-card__calories">
            {{ meal().totalCalories | number:'1.0-0' }}
            <span class="meal-card__calories-unit">{{ 'MEAL_CARD.KCAL' | translate }}</span>
        </div>
    </div>

    <div class="meal-card__body">
        <div class="meal-card__macros">
            @for (chip of macroChips(); track chip.label) {
                <span class="meal-card__chip">
                    <span class="meal-card__chip-dot" [style.background]="chip.color"></span>
                    {{ chip.value | number:'1.0-0' }} {{ 'GENERAL.UNITS.G' | translate }}
                    {{ chip.label | translate }}
                </span>
            }
        </div>

        <div class="meal-card__gallery">
            @for (image of previewImages(); track idx; let idx = $index) {
                <div
                    class="meal-card__thumb meal-card__thumb--stack"
                    [style.zIndex]="20 - idx"
                    [style.marginLeft.px]="idx === 0 ? 0 : -14"
                >
                    <img [ngSrc]="image" width="40" height="40" alt="" loading="lazy" />
                </div>
            }
            @if (extraCount() > 0) {
                <div
                    class="meal-card__thumb meal-card__thumb--stack meal-card__thumb--more"
                    [style.marginLeft.px]="previewImages().length ? -14 : 0"
                    [style.zIndex]="10"
                >
                    +{{ extraCount() }}
                </div>
            }
        </div>
    </div>
</div>
