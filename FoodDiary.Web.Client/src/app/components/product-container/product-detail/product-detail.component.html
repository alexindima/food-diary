<fd-ui-dialog [title]="product.name" size="lg">
    <fd-ui-tabs class="product-detail__tabs"
        [tabs]="tabs"
        [selectedValue]="activeTab"
        (selectedValueChange)="onTabChange($event)"
     />

    <div class="product-detail">
        @switch (activeTab) {
            @case ('summary') {
                <div class="product-detail__summary">
                    <fd-ui-accent-surface class="product-detail__surface product-detail__surface--summary"
                        accentSide="top"
                        accentColor="var(--fd-color-primary-300, #93C5FD)"
                        [tinted]="true"
                     >
                        <span class="product-detail__surface-label">{{ 'PRODUCT_DETAIL.SUMMARY.CALORIES' | translate }}</span>
                        <strong class="product-detail__surface-value">
                            {{ calories }}
                            {{ 'PRODUCT_LIST.KCAL' | translate }}
                        </strong>
                    </fd-ui-accent-surface>

                    @if (product.barcode) {
                        <fd-ui-accent-surface class="product-detail__surface product-detail__surface--summary"
                            accentSide="top"
                            accentColor="var(--fd-color-primary-300, #93C5FD)"
                            [tinted]="true"
                        >
                            <span class="product-detail__surface-label">{{ 'PRODUCT_DETAIL.SUMMARY.BARCODE' | translate }}</span>
                            <strong class="product-detail__surface-value">{{ product.barcode }}</strong>
                        </fd-ui-accent-surface>
                    }

                    <fd-ui-accent-surface class="product-detail__surface product-detail__surface--summary"
                        accentSide="top"
                        accentColor="var(--fd-color-primary-300, #93C5FD)"
                        [tinted]="true"
                    >
                        <span class="product-detail__surface-label">{{ 'PRODUCT_DETAIL.SUMMARY.SERVING' | translate }}</span>
                        <strong class="product-detail__surface-value">
                            {{ product.baseAmount }}
                            {{ ('PRODUCT_AMOUNT_UNITS_SHORT.' + product.baseUnit) | translate }}
                        </strong>
                    </fd-ui-accent-surface>

                    <fd-ui-accent-surface class="product-detail__surface product-detail__surface--summary"
                        accentSide="top"
                        accentColor="var(--fd-color-primary-300, #93C5FD)"
                        [tinted]="true"
                    >
                        <span class="product-detail__surface-label">{{ 'PRODUCT_DETAIL.SUMMARY.PRODUCT_TYPE' | translate }}</span>
                        <strong class="product-detail__surface-value">{{ productTypeKey | translate }}</strong>
                    </fd-ui-accent-surface>
                </div>
            }
            @case ('nutrients') {
                <div class="product-detail__nutrients">
                    <div class="product-detail__macro-grid">
                        @for (macro of macroBlocks; track macro.labelKey) {
                            <fd-ui-accent-surface class="product-detail__surface"
                                accentSide="top"
                                [accentColor]="macro.color"
                                [tinted]="true"
                            >
                                <span class="product-detail__surface-label">{{ macro.labelKey | translate }}</span>
                                <strong class="product-detail__surface-value">
                                    {{ macro.value }}
                                    {{ macro.unitKey | translate }}
                                </strong>
                            </fd-ui-accent-surface>
                        }
                    </div>
                    <div class="product-detail__charts">
                        <div class="product-detail__chart" [style.width.px]="chartSize" [style.height.px]="chartSize">
                            <canvas
                                baseChart
                                [style.width.px]="chartSize"
                                [style.height.px]="chartSize"
                                [data]="pieChartData"
                                [options]="pieChartOptions"
                                [type]="'pie'"
                                [legend]="false"
                            ></canvas>
                        </div>
                        <div class="product-detail__chart" [style.width.px]="chartSize" [style.height.px]="chartSize">
                            <canvas
                                baseChart
                                [style.width.px]="chartSize"
                                [style.height.px]="chartSize"
                                [data]="barChartData"
                                [options]="barChartOptions"
                                [type]="'bar'"
                                [legend]="false"
                            ></canvas>
                        </div>
                    </div>
                </div>
            }
        }
    </div>

    <div fdUiDialogFooter class="product-detail__footer">
        @if (warningMessage) {
            <span class="product-detail__warning">{{ warningMessage | translate }}</span>
        }
        <div class="product-detail__actions">
            @if (canModify) {
                <fd-ui-button size="md" variant="secondary" icon="edit" (click)="onEdit()">
                    {{ 'PRODUCT_DETAIL.EDIT_BUTTON' | translate }}
                </fd-ui-button>
                <fd-ui-button size="md" variant="danger" icon="delete" (click)="onDelete()">
                    {{ 'PRODUCT_DETAIL.DELETE_BUTTON' | translate }}
                </fd-ui-button>
            } @else {
                <fd-ui-button
                    size="md"
                    variant="secondary"
                    fill="outline"
                    icon="content_copy"
                    [disabled]="isDuplicateInProgress"
                    (click)="onDuplicate()"
                >
                    {{ 'PRODUCT_DETAIL.DUPLICATE_BUTTON' | translate }}
                </fd-ui-button>
            }
        </div>
    </div>
</fd-ui-dialog>
