<div class="modal">
    <h2 class="modal__title">{{ 'CONSUMPTION_DETAIL.TITLE' | translate }} {{ consumption.date | date:'dd.MM.yyyy' }} - {{ consumption.date | date:'HH:mm' }}</h2>
    <hr class="modal__divider" />
    <div class="modal__body">
        <div class="modal__info">
            @if (consumption.comment) {
                <p class="modal__comment">{{ consumption.comment }} </p>
            }
            @if (consumption.mealType) {
                <p class="modal__text modal__text--muted">
                    {{ 'CONSUMPTION_DETAIL.MEAL_TYPE' | translate }}:
                    {{ ('MEAL_TYPES.' + consumption.mealType) | translate }}
                </p>
            }
            <div class="modal__items">
                <p class="modal__text modal__text--muted">
                    {{ 'CONSUMPTION_DETAIL.ITEMS_LIST' | translate:{ count: consumption.items.length } }}
                </p>
                <ul class="modal__item-list">
                    @for (item of consumption.items; track item) {
                        <li class="modal__item">
                            <span class="modal__item-name">{{ item.product?.name || item.recipe?.name }}</span>
                            @if (item.product) {
                                <span class="modal__item-meta">
                                    {{ item.amount | number:'1.0-2' }}
                                    {{ ('PRODUCT_AMOUNT_UNITS_SHORT.' + item.product.baseUnit) | translate }}
                                </span>
                            } @else if (item.recipe) {
                                <span class="modal__item-meta">
                                    {{ item.amount | number:'1.0-2' }}
                                    {{ 'CONSUMPTION_DETAIL.SERVINGS' | translate }}
                                </span>
                            }
                        </li>
                    }
                </ul>
            </div>
        </div>
        <fd-nutrients-summary
            [calories]="calories"
            [nutrientChartData]="nutrientChartData"
            [fiberValue]="consumption.totalFiber"
            [config]="nutrientSummaryConfig"
        ></fd-nutrients-summary>
    </div>
    <div class="modal__footer">
        <div class="modal__actions">
            <button
                class="modal__button"
                appearance="primary"
                tuiButton
                size="m"
                iconStart="@tui.pen-line"
                (click)="onEdit()"
            >
                {{ 'CONSUMPTION_DETAIL.EDIT_BUTTON' | translate }}
            </button>
            <button
                class="modal__button modal__button--accent"
                appearance="accent"
                tuiButton
                size="m"
                iconStart="@tui.trash-2"
                (click)="onDelete()"
            ></button>
        </div>
    </div>
</div>

<ng-template #confirmDialog let-observer>
    <div class="dialog">
        <p class="dialog__content">
            {{ 'CONSUMPTION_DETAIL.CONFIRM_DELETE_TITLE' | translate }}
            <span class="dialog__highlight">{{ consumption.date | date }}</span>?
        </p>
        <div class="dialog__buttons">
            <button class="dialog__button"
                    appearance="primary"
                    tuiButton
                    size="m"
                    (click)="observer.complete()"
            >
                {{ 'CONSUMPTION_DETAIL.CANCEL_BUTTON' | translate }}
            </button>
            <button
                class="dialog__button dialog__button--accent"
                appearance="accent"
                tuiButton
                size="m"
                (click)="observer.next(true);
                 observer.complete()"
            >
                {{ 'CONSUMPTION_DETAIL.CONFIRM_BUTTON' | translate }}
            </button>
        </div>
    </div>
</ng-template>
